;(function($,window){'use strict';$.plugin('swImageGallery',{defaults:{imageContainerSelector:'.image-slider--container',imageSlideSelector:'.image-slider--slide',thumbnailContainerSelector:'.image-slider--thumbnails',imageGalleryClass:'image--gallery',previousKeyCode:37,nextKeyCode:39,maxZoom:'auto',disabledClass:'is--disabled',btnClass:'btn is--small',zoomInClass:'icon--plus3 button--zoom-in',zoomOutClass:'icon--minus3 button--zoom-out',zoomResetClass:'icon--resize-shrink button--zoom-reset'},init:function(){var me=this;me.applyDataAttributes();me._$imageContainer=me.$el.find(me.opts.imageContainerSelector);if(!me._$imageContainer.length){return;}
me._$thumbContainer=me.$el.find(me.opts.thumbnailContainerSelector);me._$imageContainerClone=me._$imageContainer.clone();me._$thumbContainerClone=me._$thumbContainer.clone();me.$zoomOutBtn=me.createZoomOutButton().appendTo(me._$imageContainerClone);me.$zoomResetBtn=me.createZoomResetButton().appendTo(me._$imageContainerClone);me.$zoomInBtn=me.createZoomInButton().appendTo(me._$imageContainerClone);me.$template=null;me.registerEvents();},createZoomInButton:function(){var me=this,opts=this.opts,$zoomInButton=$('<div>',{'class':opts.btnClass+' '+opts.zoomInClass});$.publish('plugin/swImageGallery/onCreateZoomInButton',[me,$zoomInButton]);return $zoomInButton;},createZoomOutButton:function(){var me=this,opts=me.opts,$zoomOutButton=$('<div>',{'class':opts.btnClass+' '+opts.zoomOutClass});$.publish('plugin/swImageGallery/onCreateZoomOutButton',[me,$zoomOutButton]);return $zoomOutButton;},createZoomResetButton:function(){var me=this,opts=me.opts,$zoomResetButton=$('<div>',{'class':opts.btnClass+' '+opts.zoomResetClass});$.publish('plugin/swImageGallery/onCreateZoomResetButton',[me,$zoomResetButton]);return $zoomResetButton;},registerEvents:function(){var me=this;me._on(me._$imageContainer.find(me.opts.imageSlideSelector),'click',$.proxy(me.onClick,me));$.subscribe('plugin/swImageSlider/onSlide',$.proxy(me.onImageUpdate,me));$.subscribe('plugin/swImageSlider/onUpdateTransform',$.proxy(me.onImageUpdate,me));me._on(window,'keydown',$.proxy(me.onKeyDown,me));$.publish('plugin/swImageGallery/onRegisterEvents',[me]);},getImageSlider:function(){var me=this,$template=me.$template,slider=($template&&$template.data('plugin_swImageSlider'))||null;$.publish('plugin/swImageGallery/onGetImageSlider',[me,slider]);return slider;},onImageUpdate:function(event,context){var me=this,plugin=me.getImageSlider();if(plugin!==context){return;}
me.toggleButtons(plugin);$.publish('plugin/swImageGallery/onImageUpdate',[me,event,plugin]);},onResetZoom:function(event){var me=this,plugin=me.getImageSlider();event.preventDefault();if(!plugin||me.$zoomResetBtn.hasClass(me.opts.disabledClass)){return;}
me.disableButtons();plugin.resetTransformation(true,function(){me.toggleButtons(plugin);$.publish('plugin/swImageGallery/onResetZoomFinished',[me,event,plugin]);});$.publish('plugin/swImageGallery/onResetZoom',[me,event,plugin]);},onZoomIn:function(event){var me=this,plugin=me.getImageSlider();event.preventDefault();if(!plugin||me.$zoomInBtn.hasClass(me.opts.disabledClass)){return;}
me.disableButtons();plugin.scale(1,true,function(){me.toggleButtons(plugin);$.publish('plugin/swImageGallery/onZoomInFinished',[me,event,plugin]);});$.publish('plugin/swImageGallery/onZoomIn',[me,event,plugin]);},onZoomOut:function(event){var me=this,plugin=me.getImageSlider();event.preventDefault();if(!plugin||me.$zoomOutBtn.hasClass(me.opts.disabledClass)){return;}
me.disableButtons();plugin.scale(-1,true,function(){me.toggleButtons(plugin);$.publish('plugin/swImageGallery/onZoomOutFinished',[me,event,plugin]);});$.publish('plugin/swImageGallery/onZoomOut',[me,event,plugin]);},onKeyDown:function(event){var me=this,opts=me.opts,plugin=me.getImageSlider(),keyCode=event.which;if(!plugin){return;}
if(keyCode===opts.previousKeyCode){plugin.slidePrev();}
if(keyCode===opts.nextKeyCode){plugin.slideNext();}
$.publish('plugin/swImageGallery/onKeyDown',[me,event,keyCode]);},createTemplate:function(){var me=this,$template,$el,img;me._$imageContainerClone.find('span[data-img-original]').each(function(i,el){$el=$(el);img=$('<img>',{'class':'image--element','src':$el.attr('data-img-original')});$el.replaceWith(img);});me._$thumbContainerClone.find('a.thumbnails--arrow').remove();me._$imageContainerClone.find('.arrow').remove();$template=$('<div>',{'class':me.opts.imageGalleryClass,'html':[me._$imageContainerClone,me._$thumbContainerClone]});$.publish('plugin/swImageGallery/onCreateTemplate',[me,$template]);return $template;},onClick:function(event){var me=this,imageSlider=me.$el.data('plugin_swImageSlider');$.modal.open(me.$template||(me.$template=me.createTemplate()),{width:'100%',height:'100%',animationSpeed:350,additionalClass:'image-gallery--modal no--border-radius',onClose:me.onCloseModal.bind(me)});me._on(me.$zoomInBtn,'click touchstart',$.proxy(me.onZoomIn,me));me._on(me.$zoomOutBtn,'click touchstart',$.proxy(me.onZoomOut,me));me._on(me.$zoomResetBtn,'click touchstart',$.proxy(me.onResetZoom,me));picturefill();me.$template.swImageSlider({dotNavigation:false,swipeToSlide:true,pinchToZoom:true,doubleTap:true,maxZoom:me.opts.maxZoom,startIndex:imageSlider?imageSlider.getIndex():0,preventScrolling:true});me.toggleButtons(me.getImageSlider());$.publish('plugin/swImageGallery/onClick',[me,event]);},onCloseModal:function(){var me=this,plugin=me.getImageSlider();if(!plugin){return;}
plugin.destroy();$.publish('plugin/swImageGallery/onCloseModal',[me]);},disableButtons:function(){var me=this,disabledClass=me.opts.disabledClass;me.$zoomResetBtn.addClass(disabledClass);me.$zoomOutBtn.addClass(disabledClass);me.$zoomInBtn.addClass(disabledClass);$.publish('plugin/swImageGallery/onDisableButtons',[me]);},toggleButtons:function(plugin){var me=this,disabledClass=me.opts.disabledClass,scale,minScale,maxScale;if(!plugin){return;}
scale=plugin.getScale();minScale=plugin.getMinScale();maxScale=plugin.getMaxScale();me.$zoomResetBtn.toggleClass(disabledClass,scale===minScale);me.$zoomOutBtn.toggleClass(disabledClass,scale===minScale);me.$zoomInBtn.toggleClass(disabledClass,scale===maxScale);$.publish('plugin/swImageGallery/onToggleButtons',[me]);},destroy:function(){var me=this,plugin=me.getImageSlider();if(plugin){plugin.destroy();}
me.$template.remove();me.$template=null;me.$zoomOutBtn.remove();me.$zoomResetBtn.remove();me.$zoomInBtn.remove();me._$imageContainer=null;me._$thumbContainer=null;me._$imageContainerClone=null;me._$thumbContainerClone=null;}});})(jQuery,window);