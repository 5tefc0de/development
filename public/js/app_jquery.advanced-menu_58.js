;(function($,window){'use strict';var $body=$('body'),$html=$('html'),isTouchIE=$html.hasClass('is--ie-touch');$.plugin('advancedMenu',{defaults:{'listSelector':'.navigation--list.container','navigationItemSelector':'.navigation--entry:not(.is--home)','navigationLinkSelector':'.navigation--link','closeButtonSelector':'.button--close','menuContainerSelector':'.menu--container','menuActiveClass':'menu--is-active','itemHoverClass':'is--hovered','hoverDelay':0},init:function(){var me=this;me.applyDataAttributes();me._$list=$(me.opts.listSelector);if(!me._$list.length){return;}
me._$listItems=me._$list.find(me.opts.navigationItemSelector);me._$closeButton=me.$el.find(me.opts.closeButtonSelector);me._targetIndex=-1;me.registerEvents();},registerEvents:function(){var me=this,$el;$.each(me._$listItems,function(i,el){$el=$(el);if(window.PointerEvent&&isTouchIE){me._on($el,'pointerdown',$.proxy(me.onClickNavigationLink,me,i));}else if(window.MSPointerEvent&&isTouchIE){me._on($el,'MSPointerDown',$.proxy(me.onClickNavigationLink,me,i));}else{me._on($el,'touchstart',$.proxy(me.onTouchStart,me,i,$el));}
me._on($el,'mouseenter',$.proxy(me.onListItemEnter,me,i,$el));me._on($el,'click',$.proxy(me.onClick,me,i,$el));});$body.on('mousemove touchstart',$.proxy(me.onMouseMove,me));me._on(me._$closeButton,'click',$.proxy(me.onCloseButtonClick,me));},onTouchStart:function(index,$el){this._shouldPrevent=!$el.hasClass(this.opts.itemHoverClass);},onClick:function(index,$el,event){var me=this;if(me._shouldPrevent||!$el.hasClass(me.opts.itemHoverClass)){event.preventDefault();event.stopImmediatePropagation();}},onListItemEnter:function(index,$el,event){var me=this,opts=me.opts;me.setMenuIndex(index);me._$list.find('.'+opts.itemHoverClass).removeClass(opts.itemHoverClass);$el.addClass(opts.itemHoverClass);if(!opts.hoverDelay||me._shouldPrevent){me.onMouseEnter(event);}else if(!me.hoverDelayTimeoutId){me.hoverDelayTimeoutId=window.setTimeout(function(){this.onMouseEnter(event);}.bind(me),opts.hoverDelay);}},onClickNavigationLink:function(index){var me=this;me._shouldPrevent=me._targetIndex!==index;me._targetIndex=index;},onMouseEnter:function(event){event.preventDefault();this.openMenu();},onMouseMove:function(event){var me=this,target=event.target,pluginEl=me.$el[0];if(pluginEl===target||$.contains(me.$el[0],target)||me._$listItems.has(target).length){return;}
if(me.hoverDelayTimeoutId){window.clearTimeout(me.hoverDelayTimeoutId);delete me.hoverDelayTimeoutId;}
me.closeMenu();},onCloseButtonClick:function(event){var me=this;event.preventDefault();me.closeMenu();$.publish('plugin/swAdvancedMenu/onCloseWithButton',[me]);},setMenuIndex:function(index){var me=this,menus=me.$el.find(me.opts.menuContainerSelector);menus.each(function(i,el){$(el).toggleClass(me.opts.menuActiveClass,i===index);});$.publish('plugin/swAdvancedMenu/onSetMenuIndex',[me,index]);},openMenu:function(){var me=this;me.$el.show();$.publish('plugin/swAdvancedMenu/onOpenMenu',[me]);},closeMenu:function(){var me=this,opts=me.opts;me._$list.find('.'+opts.itemHoverClass).removeClass(opts.itemHoverClass);me.$el.hide();me._targetIndex=-1;$.publish('plugin/swAdvancedMenu/onCloseMenu',[me]);}});})(jQuery,window);$(function(){$('*[data-advanced-menu="true"]').advancedMenu();});