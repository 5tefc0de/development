;(function($,window){'use strict';$.plugin('swAddArticle',{defaults:{'eventName':'click','addArticleUrl':window.controller['ajax_add_article'],'sliderPerPageDefault':3,'showModal':true,'productSliderSelector':'.js--modal .product-slider'},init:function(){var me=this,opts=me.opts;me.applyDataAttributes();opts.showModal=!!opts.showModal&&opts.showModal!=='false';me._on(me.$el,opts.eventName,$.proxy(me.sendSerializedForm,me));$('body').delegate('*[data-modal-close="true"]','click.modal',$.proxy(me.closeModal,me));StateManager.addPlugin(opts.productSliderSelector,'swProductSlider');},sendSerializedForm:function(event){event.preventDefault();var me=this,opts=me.opts,$el=me.$el,ajaxData=$el.serialize();ajaxData+='&isXHR=1';if(opts.showModal){$.loadingIndicator.open({'openOverlay':true});}
$.publish('plugin/swAddArticle/onBeforeAddArticle',[me,ajaxData]);$.ajax({'type':'POST','data':ajaxData,'url':opts.addArticleUrl,'dataType':'html','success':function(result){$.publish('plugin/swAddArticle/onAddArticle',[me,result]);if(!opts.showModal){return;}
$.loadingIndicator.close(function(){$.modal.open(result,{width:750,sizing:'content',onClose:me.onCloseModal.bind(me)});picturefill();StateManager.updatePlugin(opts.productSliderSelector,'swProductSlider');$.publish('plugin/swAddArticle/onAddArticleOpenModal',[me,result]);});}});},closeModal:function(event){event.preventDefault();$.modal.close();$.publish('plugin/swAddArticle/onCloseModal',[this]);},onCloseModal:function(){var me=this;StateManager.destroyPlugin(me.opts.productSliderSelector,'swProductSlider');$.publish('plugin/swAddArticle/onCloseModal',[me]);}});})(jQuery,window);